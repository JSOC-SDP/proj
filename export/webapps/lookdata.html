<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso-8859-1">
<TITLE>JSOC Lookdata</TITLE>
<SCRIPT TYPE="text/javascript" SRC="prototype-1.6.0.2.js"></SCRIPT>

<style type="text/css">

#body { margin:0; padding:0; }
#header { position:relative; top:0; left:0; width:100%; background:#eee; }
#footer { position:fixed; bottom:0; left:0; width:100%; background:#eee; }

#SeriesDiv { position:relative; margin:5px; }
#MySeriesDiv { position:relative; margin:5px; }
#SeriesInfoDiv { position:relative; margin:5px; }
#FullInfoDiv { position:relative; margin:5px; }
#FullDisplayInfoDiv { position:relative; margin:5px; }

#SeriesSelect { width:40em; }
#KeysSelect { width:20em; }
#SegsSelect { width:20em; }
#SeriesFilter { width:20em; }
#RecordSet { width:30em; font-size:100%; }
#SeriesButton { width:15em; }

#InfoTable { border-spacing:1px; white-space:nowrap; }
td {padding:2px; }
</style>
 
<script type="text/javascript">
// #ExportRequestDiv { position:relative; margin:5px; }

// 
// Documents for the server side tools can be found at
// "http://jsoc.stanford.edu/jsocwiki/AjaxJsocConnect"
//

// Global variables and initialize page locations

var SeriesData = "";
var CurrentSeries = 0;
var SeriesName = "";
var SeriesKeySegInfo = "";
var KeyList = "";
var SegList = "";
var nkeysselected = 0;
var nsegsselected = 0;
var RecordCount = 0;
var askedCount = 0;
var KeyValsFetched = 0;
var ExportRecordSetOK = 0;
var ExportProtocolOK = 0;
var ExportMethodOK = 0;
var ExportUserOK = 0;
var ExportNotifyOK = 0;
var ExportReadyOK = 0;

var GetSeriesObject;
var GetValuesObject;

function InitPage()
  {
  $("SeriesFilter").value = "NOT ^dsds\\.";
  CleanSeriesSelect();
  ExportUserOK = 0;
  ExportNotifyOK = 0;
  $("ExportRequestor").value = "";
  $("ExportProcessing").value = "no_op";
  $("ExportNotify").value = "";
  $("ExportNotifyConf").value = "";
  $("RequestID").innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
  $("StatusLocation").innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
  $("ExportStatus").innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
  $("StatusDataLocation").innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
  // AbortGetKeyValues(); ---- do not do this here!!
  // GetSeriesAbort(); ---- do not do this here!!
  }


function CleanSeriesSelect()
  {
  for (var i=$("SeriesSelect").length; i > 0; i--)
    {
    $("SeriesSelect").remove(i-1);
    }
  CleanSeriesInfo();
  }

function CleanSeriesInfo()
  {
  SeriesName = "";
  ExportReadyOK = 0;
  ExportProtocolOK = 0;
  ExportRecordSetOK = 0;
  ExportMethodOK = 0;
  $("RecordSet").value = "";
  $("ExportRecordSet").innerHTML = "";
  $("ExportProtocol").value = "as-is";
  $("ExportMethod").value = "url_quick";
  $("ExportButton").value = "Submit Export Request";
  $("ExportButtonMsg").innerHTML = "Please only click once for export request.";
  $("ExportButton").style.backgroundColor = "#D8D8D8";
  $("SeriesButton").disabled = false;
  $("FetchKeyValsButton").disabled = false;
  $("FetchKeyValsButton").value = "Fetch Keyword Values for RecordSet";
  $("FetchKeyValsButton").style.backgroundColor = "#FFFF80";
  $("Series_Info_Place").innerHTML = "";
  $("Series_Name_Place").innerHTML = "";
  $("FirstLastPlace").innerHTML = "";
  $("SeriesCountPlace").innerHTML = "<I>TBD</I>";
  CleanSeriesPick();
  }

function CleanSeriesPick()
  {
  $("KeyListPlace").innerHTML = "All Keywords";
  $("SegListPlace").innerHTML = "All Segments";
  $("DisplayPlace").innerHTML = "";
  KeyList = "";
  SegList = "";
  $("SSKeysPlace").innerHTML = "";
  $("SSPlace").innerHTML = "";
  $("RSCount_Place").innerHTML = "";
  RecordCount = 0;
  nkeysselected = 0;
  nsegsselected = 0;
  askedCount = 0;
  $("WantRecInfo").checked = 1;
  $("RecSetPlace").innerHTML = "";
  CleanKeysSelect();
  }

function CleanKeysSelect()
  {
  KeyValsFetched = 0;
  for (var i=$("KeysSelect").length; i > 0; i--)
    $("KeysSelect").remove(i-1);
  for (var i=$("SegsSelect").length; i > 0; i--)
    $("SegsSelect").remove(i-1);
  $("WantRecInfo").checked = 1;
  $("DisplayPlace").innerHTML = "";
  $("SegListPlace").innerHTML = "";
  $("KeyListPlace").innerHTML = "";
  KeyList =  "";
  SegList =  "";
  CleanOnLoad();
  }

function CleanOnLoad()
  {
  $("AbortGetSeriesButton").hide();
  $("AbortKeyValsButton").hide();
  $("FetchKeyValsButton").style.backgroundColor = "#FFFF80";
  $("SeriesButton").style.backgroundColor = "#FFFF80";
  $("SeriesDiv").style.display="block";
  $("SeriesDivButton").style.backgroundColor = "FFD8D8";
  $("FullInfoDiv").style.display="block";
  $("FullInfoDivButton").style.backgroundColor = "FFD8D8";
  $("ExportRequestDiv").style.display="none";
  $("ExportRequestDivButton").style.backgroundColor = "D8FFD8";
  }

// Hide and show DIVs on button click.
// Arg is div id.
// Button id should be div id with suffix of "Button"

function ToggleSectionDiv(divname)
  {
  var button = $(divname + "Button");
  var div = $(divname);
  if (div.style.display == "block")
    {
    button.style.backgroundColor = "D8FFD8";
    button.value = "Show Section";
    div.style.display="none";
    }
  else
    {
    button.style.backgroundColor = "FFD8D8";
    button.value = "Hide Section";
    div.style.display="block";
    }
  }


function insertOption(list,text,note)
  {
  var y=document.createElement('option');
  y.value=text;
  if (note.length)
    y.text = text + "  --- " + note;
  else
    y.text = text;
  var x = $(list);
  try
    {
    x.add(y,null); // standards compliant
    }
  catch(ex)
    {
    x.add(y); // IE only
    }
  }

var myGlobalHandlers = {
	onCreate: function()
	  {
          $("AjaxBusy").innerHTML = Ajax.activeRequestCount;
          Element.show('systemWorking');
          },
	onComplete: function()
          {
          if(Ajax.activeRequestCount == 0)
            {
            $("AjaxBusy").innerHTML = "0";
	    Element.hide('systemWorking');
            }
          }
};

Ajax.Responders.register(myGlobalHandlers);

// Section 1.0 support, Get list of series and build select list for 2.0

function GetSeriesAbort()
  {
  if (GetSeriesObject == undefined)
    {
    return;
    }
  else if (GetSeriesObject.transport.readyState != 4)
    {
    GetSeriesObject.transport.abort();
    $("SeriesButton").style.backgroundColor = "#FFFF80";
    $("SeriesButton").value = "Fetch seriesname list";
    $("SeriesButton").disabled = false;
    $("AbortGetSeriesButton").hide();
    }
  }

function GetSeries()
  {
  $("AjaxBusy").innerHTML = Ajax.activeRequestCount;
  CleanSeriesInfo();
  $("SeriesButton").value = "Processing...";
  $("SeriesButton").style.backgroundColor = "#FFC8C8";
  $("SeriesButton").disabled = true;
  $("AbortGetSeriesButton").show();
  $("SeriesCountPlace").innerHTML = "<I>wait...</I>";
  GetSeriesObject = new Ajax.Request('http://jsoc.stanford.edu/cgi-bin/ajax/show_series',
    {
    method: 'get',
    parameters: {"filter" : $("SeriesFilter").value },
    onSuccess: function(transport, json)
      {
      var response = transport.responseText || "no response text";
      SeriesData = response.evalJSON();
      CleanSeriesSelect();
      var n = SeriesData.n;
      for (var i = 0; i < n; i++)
        {
	insertOption("SeriesSelect",SeriesData.names[i].name,SeriesData.names[i].note);
        }
      $("SeriesCountPlace").innerHTML = SeriesData.n ;
      $("SeriesButton").style.backgroundColor = "#FFFF80";
      $("SeriesButton").value = "Fetch seriesname list";
      $("SeriesButton").disabled = false;
      $("AbortGetSeriesButton").hide();
      $("AjaxBusy").innerHTML = Ajax.activeRequestCount;
      },
    onFailure: function() { alert('Something went wrong...'); },
    onComplete: function() { $("AjaxBusy").innerHTML = Ajax.activeRequestCount; }
    });
  $("AjaxBusy").innerHTML = Ajax.activeRequestCount;
  }

// Section 2.0 support Select seriesfrom select list made in section 1.0
// Uses jsoc_info op=series_struct
// Get list of all keywords and segments with supporting info
// Fetches full list of keywords and segments for display in section 4 and
// build select lists used in section 4 and 5.
// If mode==0 then use the SeriesSelect box for the chosen series.
// else if mode==1 then use the SeriesName variable as is and fetch
// info and reset all associated references.
// If mode==2 then the section 3 series name becomes the new SeriesName
// and info for it will be found and displayed.

function PickSeries(mode)
  {
  $("AjaxBusy").innerHTML = Ajax.activeRequestCount;
  CleanSeriesPick();
  if (mode == 0)
    {
    CurrentSeries = $("SeriesSelect").selectedIndex;
    SeriesName = $("SeriesSelect").options[CurrentSeries].value;
    }
  if (mode != 2)
    {
    $("RecordSet").value = SeriesName;
    }
  $("Series_Name_Place").innerHTML = SeriesName;
  $("RecSetPlace").innerHTML = SeriesName;
  $("FirstLastPlace").innerHTML = "... Fetching Series Information ...";
  new Ajax.Request('http://jsoc.stanford.edu/cgi-bin/ajax/jsoc_info',
    {
    method: 'get',
    parameters: {"ds" : SeriesName, "op" : "series_struct" },

    onSuccess: function(transport, json)
      {
      $("AjaxBusy").innerHTML = Ajax.activeRequestCount;
      var response = transport.responseText || "no response text";
      var data = response.evalJSON();
      if (data.status == 1)
        {
        $("SSPlace").innerHTML = "No Series Struct Found";
        $("SSKeysPlace").innerHTML = "";
        CleanKeysSelect();
        }
      else
        {
        $("Series_Info_Place").innerHTML = "Note: " + data.note;
	var n = data.primekeys.length;
	var primes = "No PrimeKeys";
	if (n > 0) primes = data.primekeys[0];
	for (i=1; i<n; i++)
	    primes = primes + ", " + data.primekeys[i];
	n = data.dbindex.length;
	var dbindex = "No DBindex";
	if (n > 0) dbindex = data.dbindex[0];
	for (i=1; i<n; i++)
	    dbindex = dbindex + ", " + data.dbindex[i];
        $("SSKeysPlace").innerHTML = "PrimeKeys: " + primes + "<BR>" +
                                     "DBindex: " + dbindex + "<P>";
	var keywords = "No keywords";
	n = data.keywords.length;
	if (n > 0)
	   {
	   insertOption("KeysSelect","**NONE**", "");
	   insertOption("KeysSelect","**ALL**", "");
	   insertOption("KeysSelect","*logdir*", "");
	   insertOption("KeysSelect","*recnum*", "");
	   keywords = "<table BORDER=1><TR><TH>keyword</TH><TH>type</TH><TH>unit</TH><TH>note</TH>"; 
	   for (i=0; i<n; i++)
	      {
	      insertOption("KeysSelect",data.keywords[i].name, "");
	      keywords = keywords + "<TR><TD>" +
		data.keywords[i].name + "</TD><TD>" +
		data.keywords[i].type + "</TD><TD>" +
		data.keywords[i].units + "&nbsp;</TD><TD>" +
		data.keywords[i].note + "&nbsp;</TD>";
	      }
	   keywords = keywords + "</table><P>";
	   }
	var segments = "No segments";
	n = data.segments.length;
	if (n > 0)
	   {
	   segments = "<table BORDER=1><TR><TD>segment</TD><TD>units</TD><TD>dims</TD><TD>protocol</TD><TD>note</TD>";
	   insertOption("SegsSelect","**NONE**", "");
	   insertOption("SegsSelect","**ALL**", "");
	   for (i=0; i<n; i++)
	      {
	      insertOption("SegsSelect",data.segments[i].name, "");
	      segments = segments + "<TR><TD>" + data.segments[i].name + "</TD><TD>" + data.segments[i].units + "&nbsp;</TD><TD>" +
		data.segments[i].dims + "&nbsp;</TD><TD>" + data.segments[i].protocol + "</TD><TD>" + data.segments[i].note + "&nbsp;</TD>";
	      }
	   segments = segments + "</table><P>";
	   }
	var links = "No links";
	n = data.links.length;
	if (n > 0)
	   {
	   links = "<table BORDER=1><TR><TD>link</TD><TD>target </TD><TD>kind</TD><TD>note</TD>";
	   for (i=0; i<n; i++)
	      links = links + "<TR><TD>" + data.links[i].name + "</TD><TD>" + data.links[i].target + "</TD><TD>" +
		data.links[i].kind + "</TD><TD>" + data.links[i].note + "&nbsp;</TD>";
	   links = links + "</table><P>";
	   }
	// Place structure table on screen
        $("SSPlace").innerHTML =  keywords + "<BR>" + segments + "<BR>" + links;
	// Place first and last record info on screen
	if (data.Interval.MaxRecnum > 0)
          $("FirstLastPlace").innerHTML = "First Record = " + data.Interval.FirstRecord + 
              "<BR>Last Record = " + data.Interval.LastRecord +
	      "<BR>First Rec., Last Rec. and largest used recnums: " + data.Interval.FirstRecnum + ", " +
              data.Interval.LastRecnum + ", " +  data.Interval.MaxRecnum + " resp." ;
	else
	  $("FirstLastPlace").innerHTML = "This series contains no records";
        }
      $("AjaxBusy").innerHTML = Ajax.activeRequestCount;
      },
    onFailure: function() { alert('Something went wrong...'); },
    onComplete: function() { $("AjaxBusy").innerHTML = Ajax.activeRequestCount; }
    });
  $("AjaxBusy").innerHTML = Ajax.activeRequestCount;
  }

// Section 3.0 support - Get record count
// Uses jsoc_info op=rs_summary which may take a while but
// also validates recordset query that will be used in section 6.

function GetRSCount()
  {
  $("AjaxBusy").innerHTML = Ajax.activeRequestCount;
  var posbracket = $("RecordSet").value.indexOf("[");
  var posRbracket = $("RecordSet").value.indexOf("]");
  if (posbracket == -1)
    {
    var thisSeriesName = $("RecordSet").value;
    }
  else
    {
    if (posRbracket == -1)
      {
      $("RSCount_Place").innerHTML = "ERROR - missing right bracket - ]";
      return;
      }
    var thisSeriesName = $("RecordSet").value.substr(0,posbracket);
    }
  if (thisSeriesName != SeriesName)
    {
    $("RSCount_Place").innerHTML = "Getting series information - wait...";
    SeriesName = thisSeriesName;
    PickSeries(2);
    }
  $("AjaxBusy").innerHTML = Ajax.activeRequestCount;
  $("RSCount_Place").innerHTML = "Getting count - wait...";
  RecordCount = -1;
  askedCount = 1;
  new Ajax.Request('http://jsoc.stanford.edu/cgi-bin/ajax/jsoc_info',
    {
    method: 'get',
    parameters: {"ds" : $("RecordSet").value, "op" : "rs_summary" },

    onSuccess: function(transport, json)
      {
      var response = transport.responseText || "no response text";
      var data = response.evalJSON();
      if (data.status != 0)
        {
	RecordCount = 0;
        $("RSCount_Place").innerHTML = "No RecordSet Count Found";
        }
      else
	{ 
	RecordCount = data.count;
	$("RSCount_Place").innerHTML = data.count;
	}
      $("ExportRecordSet").innerHTML = $("RecordSet").value;
      $("RecSetPlace").innerHTML = $("RecordSet").value;
      ExportReadyOK = 0;
      ExportRecordSetOK = 1;
      $("ExportButtonMsg").innerHTML = "Please only click once for export request.";
      $("ExportButton").value = "Submit Export Request";
      $("ExportButton").style.backgroundColor = "#D8D8D8";
      if (KeyValsFetched == 1)
        {
        $("FetchKeyValsButton").value = "Update Keyword Values for RecordSet";
        $("FetchKeyValsButton").style.backgroundColor = "#FFD8D8";
        }
      },
    onFailure: function() { alert('Something went wrong...'); },
    onComplete: function() { $("AjaxBusy").innerHTML = Ajax.activeRequestCount; }
    });
  }


// Section 4, Select keys for fetching values
// Uses select list of keyword names made in section 4.
// Places result in list to be used in section 6.

function PickKeys()
  {
  var ikey = 0;
  nkeysselected = 0;
  var nkeys = $("KeysSelect").length;
  var selkeys =  "";
  $("KeyListPlace").innerHTML = "";
  $("DisplayPlace").innerHTML = "";
  // $("WantRecInfo").checked = 0;
  KeyList =  "";
  selkeys = "";
  // check for **NONE**
  if ($("KeysSelect")[0].selected)
    {
    nkeysselected = 0;
    selkeys = "**NONE**";
    KeyList = "**NONE**";
    }
  // check for **ALL**
  // else if ($("KeysSelect")[1].selected)
    // {
    // nkeysselected = nkeys - 2;
    // selkeys = "**ALL**";
    // KeyList = "**ALL**";
    // }
  else
   for (ikey=0; ikey < nkeys; ikey++)
    if ($("KeysSelect")[ikey].selected)
      {
      if (nkeysselected)
	{
	selkeys = selkeys + ", ";
        KeyList = KeyList + ",";
	}
      nkeysselected = nkeysselected + 1;
      selkeys = selkeys + $("KeysSelect")[ikey].text;
      KeyList = KeyList + $("KeysSelect")[ikey].text;
      }
  $("KeyListPlace").innerHTML = nkeysselected + " Keys Chosen:&nbsp;" + selkeys;
  }

// Section 5., Select segments for fetching pathnames
// Uses select list of segment names made in section 4.
// Places result in list to be used in section 6.

function PickSegs()
  {
  var iseg = 0;
  nsegsselected = 0;
  var nsegs = $("SegsSelect").length;
  var selsegs =  "";
  $("SegListPlace").innerHTML = "";
  $("DisplayPlace").innerHTML = "";
  // $("WantRecInfo").checked = 0;
  SegList =  "";
  selsegs = "";
  // check for **NONE**
  if ($("SegsSelect")[0].selected)
    {
    nsegsselected = 0;
    selsegs = "**NONE**";
    SegList = "**NONE**";
    }
  // check for **ALL**
  else if ($("SegsSelect")[1].selected)
    {
    nsegsselected = nsegs - 2;
    selsegs = "**ALL**";
    SegList = "**ALL**";
    }
  else
   for (iseg=0; iseg < nsegs; iseg++)
    if ($("SegsSelect")[iseg].selected)
      {
      if (nsegsselected)
	{
	selsegs = selsegs + ", ";
        SegList = SegList + ",";
	}
      nsegsselected = nsegsselected + 1;
      selsegs = selsegs +  $("SegsSelect")[iseg].text;
      SegList = SegList +  $("SegsSelect")[iseg].text;
      }
  $("SegListPlace").innerHTML = nsegsselected + " Segs Chosen:&nbsp;" + selsegs;
  }

// Section 6.0 - Get record values for selected keywords and segments
// Uses jsoc_info op=rs_list
// Places result in table.

function AbortGetKeyValues()
  {
  if (GetValuesObject == undefined)
    {
    return;
    }
  else if (GetValuesObject.transport.readyState != 4)
    {
    GetValuesObject.transport.abort();
    $("FetchKeyValsButton").value = "Fetch Keyword Values for RecordSet";
    $("FetchKeyValsButton").style.backgroundColor = "#FFFF80";
    $("FetchKeyValsButton").disabled = false;
    $("AbortKeyValsButton").hide();
    $("DisplayPlace").innerHTML = "Request aborted";
    }
  }

function GetKeyValues()
  {
  $("AjaxBusy").innerHTML = Ajax.activeRequestCount;
  var getparameters = new Hash( {"ds" : $("RecordSet").value, "op" : "rs_list" });
  $("DisplayPlace").innerHTML = "Requesting Recordset Key Values ...";
  if (nkeysselected < 1 && nsegsselected < 1)
    {
    $("DisplayPlace").innerHTML = "No keywords and NO segments requested.<BR>Please fo back to steps 4 and 5."; 
    return;
    }
  if (nkeysselected)
    getparameters = getparameters.merge({"key": KeyList});
  else
    getparameters = getparameters.merge({"key":"**NONE**"});
  if (nsegsselected)
    getparameters = getparameters.merge({"seg": SegList});
  else
    getparameters = getparameters.merge({"seg":"**NONE**"});
  if ($("WantRecInfo").checked) getparameters = getparameters.merge({"R":1});
  if (RecordCount == 0 && askedCount == 0)
      GetRSCount();
  if (RecordCount < 0)
    {
      $("DisplayPlace").innerHTML = "RecordSet count underway (step 3), please wait for it to complete before retrying";
      return;
    }
  if (RecordCount == 0)
    {
    $("DisplayPlace").innerHTML = "There are no records in the chosen RecordSet";
    return;
    }
  if (RecordCount > 10000)
    {
    $("DisplayPlace").innerHTML = "Requested Recordset is too large for this function, " + RecordCount + 
	" records.<BR>Please go back to step 3 and choose a smaller recordset.";
    return;
    }
  $("FetchKeyValsButton").value = "Processing ...";
  $("FetchKeyValsButton").style.backgroundColor = "#FFD8D8";
  $("FetchKeyValsButton").disabled = true;
  $("AbortKeyValsButton").show();
  GetValuesObject = new Ajax.Request('http://jsoc.stanford.edu/cgi-bin/ajax/jsoc_info',
    {
    method: 'get',
    parameters: getparameters.toObject(),

    onSuccess: function(transport, json)
      {
      var response = transport.responseText || "no response text";
      var data = response.evalJSON();
      var valuetable = "";
      if (data.status == 1)
        {
        $("DisplayPlace").innerHTML = data.error;
	AbortGetKeyValues();
        }
      else
        {
        $("FetchKeyValsButton").value = "Fetch Keyword Values for RecordSet";
        $("FetchKeyValsButton").style.backgroundColor = "#FFFF80";
        $("FetchKeyValsButton").disabled = false;
        $("AbortKeyValsButton").hide();
        KeyValsFetched = 1;
	var thissegdata = "";
	nkeys = data.keywords.length;
	nsegs = data.segments.length;
	nrecs = data.count;
        $("DisplayPlace").innerHTML = "Status = " + data.status + ", Recordset Key Values for " + data.count + " records returned, preparing page ...";
        wantrecinfo = $("WantRecInfo").checked;
	valuetable = "<TABLE border=1 id='InfoTable' ><TR>"
	if (wantrecinfo)
	  valuetable = valuetable +  "<TH>RecordName</TH><TH>Online</TH>"
	for (ikey=0; ikey < nkeys; ++ikey)
           valuetable = valuetable + "<TH>" + data.keywords[ikey].name + "</TH>";
	for (iseg=0; iseg < nsegs; ++iseg)
           {
           valuetable = valuetable + "<TH>segment: " + data.segments[iseg].name + "</TH>";
           valuetable = valuetable + "<TH>seg_dims: " + data.segments[iseg].name + "</TH>";
           }
	valuetable = valuetable + "</TR>";

	for (irec=0; irec < nrecs; irec++)
	  {
	  valuetable = valuetable + "<TR>";
	  if (wantrecinfo)
	    valuetable = valuetable +  "<TD>" + data.recinfo[irec].name + "</TD><TD>" + data.recinfo[irec].online +  "</TD>";
	  for (ikey=0; ikey<nkeys; ikey++)
	   {
	   this_keyval =  data.keywords[ikey].values[irec];
	   if (data.keywords[ikey].name == "*logdir*")
	     {
	     if (this_keyval.charAt(0) == '/')
	       {
	       tmp = "<A HREF=http://jsoc.stanford.edu" + this_keyval + ">" + this_keyval + "</A>";
	       this_keyval = tmp;
	       }
             }
           valuetable = valuetable + "<TD>" + this_keyval + "</TD>";
	   }
	  for (iseg=0; iseg<nsegs; iseg++)
	   {
	   thissegdims = data.segments[iseg].dims[irec];
	   thissegdata = data.segments[iseg].values[irec];
           if (wantrecinfo && data.recinfo[irec].online)
	      {
	      tmp = "<A HREF=http://jsoc.stanford.edu" + thissegdata + ">" + thissegdata + "</A>";
	      thissegdata = tmp;
	      }
        $("DisplayPlace").innerHTML = "seg " + iseg + thissegdata + "done";
           valuetable = valuetable + "<TD>" + thissegdata + "</TD>";
           valuetable = valuetable + "<TD>" + thissegdims + "</TD>";
	   }
	  valuetable = valuetable + "</TR>";
	  }
	valuetable = valuetable + "</TABLE>";
        $("DisplayPlace").innerHTML =  valuetable + "<BR>";
        }
      },
    onFailure: function() { alert('Something went wrong...'); },
    onComplete: function() { $("AjaxBusy").innerHTML = Ajax.activeRequestCount; }
    });
  }

// Section 7. - Export request

function CreateDataTable(data, valuetable)
  {
  $("AjaxBusy").innerHTML = Ajax.activeRequestCount;
  valuetable = "";
  var count = data.count;
  valuetable = "<TABLE BORDER=1>"
  valuetable = valuetable + "<TR><TD>File</TD><TD>Record</TD><TD>Filename</TD></TR>"
  for (ifile=0; ifile < count; ifile++)
    {
    valuetable = valuetable + "<TR>";
    valuetable = valuetable +  "<TD>" + (ifile + 1) + "</TD>";
    valuetable = valuetable +  "<TD>" + data.data[ifile].record + "</TD>";

    thisfile = data.data[ifile].filename;
    tmp = "<A HREF=http://jsoc.stanford.edu" + data.dir + "/" + thisfile + ">" + thisfile + "</A>";
    valuetable = valuetable +  "<TD>" + tmp + "</TD>";
    valuetable = valuetable + "</TR>";
    }
  valuetable = valuetable + "</TABLE>";
  return valuetable;
  }

function ExportNop()
  {
  }

function SetExportMethod()
  {
  $("ExportMethod").value = $("ExportMethod").value.toLowerCase();
  if ($("ExportMethod").value == "url" || $("ExportMethod").value == "url_quick" || $("ExportMethod").value == "url_direct")
    ExportMethodOK = 1;
  else
    {
    alert("Please set Method to url, url_quick, or url_direct");
    ExportMethodOK = 0;
    }
  }

function SetExportProtocol()
  {
  var tmp = $("ExportProtocol").value.toUpperCase();
  if ($("ExportProtocol").value == "as-is" || tmp == "FITS")
    {
    if (tmp == "FITS")
      {
      $("ExportProcessing").value = "fullres";
      $("ExportProtocol").value = "FITS";
      ExportProtocolOK = 2;
      }
    else
      {
      $("ExportProcessing").value = "no_op";
      ExportProtocolOK = 1;
      }
    }
  else
    {
    ExportProtocolOK = 0;
    alert('Export Protocol - must be "as-is" or "FITS"'); 
    $("ExportProtocol").value = "";
    }
  }

function SetExportUser()
  {
  if ($("ExportRequestor").value.length != 0)
    ExportUserOK = 1;
  else
    {
    alert("Please set non-empty name for Requestor");
    ExportUserOK = 0;
    }
  }

function SetExportNotify()
  {
  var tmp1 = $("ExportNotify").value.toUpperCase();
  var tmp2 = $("ExportNotifyConf").value.toUpperCase();
  if (tmp1.length == 0)
    {
    ExportNotifyOK = 0;
    alert("Please enter e-mail address in Notify and Confirm fields.");
    return;
    }
  if ( tmp1 == tmp2 )
    {
    if ( tmp1 ==  "SOLARMAIL" )
      ExportNotifyOK = 2;
    else if ( tmp1 == "NONE" || tmp1 == "NO")
      ExportNotifyOK = 3;
    else
      ExportNotifyOK = 1;
    }
  else
    {
    alert("Please enter same e-mail address in both places.");
    ExportNotifyOK = 0;
    }
  }


function GetExport()
  {
  $("AjaxBusy").innerHTML = Ajax.activeRequestCount;
  if (ExportReadyOK == 3)
    {
    alert("Processing request, please wait...");
    return;
    }
  if (ExportRecordSetOK == 0)
    {
    $("ExportButtonMsg").innerHTML = "Retry after step 3.";
    alert("RecordSet not verified, go to Step 3 then retry export request.");
    return;
    }
  SetExportMethod();
  if (ExportMethodOK == 0)
    {
    $("ExportButtonMsg").innerHTML = "Retry after entering export method";
    alert("Method not given, Enter export method then retry export request.");
    return;
    }
  SetExportProtocol();
  if (ExportProtocolOK == 0)
    {
    $("ExportButtonMsg").innerHTML = "Retry after entering export protocol";
    alert("Protocol not given, Enter export protocol then retry export request.");
    return;
    }
  if ($("ExportProtocol").value == "FITS" || $("ExportProtocol").value == "as-is")
    {
    }
  else
    {
    SetExportUser();
    if (ExportUserOK == 0)
      {
      $("ExportButtonMsg").innerHTML = "Retry after entering your identification in Requestor field";
      alert("Requestor not given, Enter name you will use in Requestor field then retry export request.");
      return;
      }
    SetExportNotify();
    if (ExportNotifyOK == 0)
      {
      $("ExportButtonMsg").innerHTML = "Retry after entering your e-mail address in Notify field";
      alert("Notify email not given or confirmed, Enter 'solarmail' or 'no' or email address then retry export request.");
      return;
      }
    }
  if (ExportReadyOK == 0)
    {
    ExportReadyOK = 3;
    $("ExportStatus").innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
    $("ExportLocation").innerHTML = "";
    $("ExportButtonMsg").innerHTML = "Export request submitted, please wait...";
    $("ExportButton").value = "Processing ...";
    $("ExportButton").style.backgroundColor = "#FFD8D8";
    var ExportRecordSetTmp = $("ExportRecordSet").innerHTML;
// "method" : ($("ExportMethod").value == "url_direct" ? "url_quick" : $("ExportMethod").value),
// "method" : $("ExportMethod").value,
    var exportparameters = new Hash( {"op" : "exp_request",
                 		     "ds" : ExportRecordSetTmp, 
                 		     "process" : $("ExportProcessing").value,
                 		     "requestor" : $("ExportRequestor").value,
                 		     "notify" : $("ExportNotify").value,
                                     "method" : ($("ExportMethod").value == "url_direct" ? "url_quick" : $("ExportMethod").value),
			 	     "format" : "json",
                 		     "protocol" : $("ExportProtocol").value });
    if (nsegsselected)
      exportparameters = exportparameters.merge({"seg": SegList});
    }
  else if (ExportReadyOK == 1)
    {
    var requestidtmp = $("RequestID").innerHTML;
    var exportparameters = new Hash( {"op" : "exp_status","requestid":requestidtmp});
    }
  else // ExportReadyOK == 2
    {
    $("ExportRecordSet").innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
    ExportRecordSetOK = 0;
    alert("Export Request Complete, Please change RecordSet to make another request");
    return;
    }

  new Ajax.Request('http://jsoc.stanford.edu/cgi-bin/ajax/jsoc_fetch',
    {
    method: 'get',
    parameters: exportparameters.toObject(),

    onSuccess: function(transport, json)
      {
      var response = transport.responseText || "no response text";
      var data = response.evalJSON();
      if (data.status == 4)
        {
        alert("Requested RecordSet not found or specification error, status=4, error=" + data.error);
        ExportReadyOK = 0;
        $("ExportButton").value = "Bad Recordset";
        $("ExportButtonMsg").innerHTML = data.error;
        $("RequestID").innerHTML = "";
        $("ExportStatus").innerHTML = "RecordSet not found";
        $("ExportLocation").innerHTML = "";
        }
      else if (data.status == 3)
        {
        alert("Requested RecordSet is too large for chosen export method.  Please contact the JSOC for help.");
        $("ExportButtonMsg").innerHTML = "Export Too Large";
        ExportReadyOK = 0;
        $("ExportButton").value = "FAILURE ...";
        $("ExportButton").style.backgroundColor = "#D8D8D8";
        $("RequestID").innerHTML = data.requestid;
        $("ExportStatus").innerHTML = "Needs Intervention, size=" + data.size + ", contact: " + data.contact;
        $("ExportLocation").innerHTML = "";
        }
      else if (data.status == 1 || data.status == 2)
	{
        if (data.status == 1)
          $("StatusButtonMsg").innerHTML = "Export request is being processed";
        else  // status==2
          $("StatusButtonMsg").innerHTML = "Export request waiting for processing";
        ExportReadyOK = 1;
        $("ExportButton").value = "Request Export Status";
        $("ExportButton").style.backgroundColor = "#D8D8D8";
        $("ExportStatus").innerHTML = "Processing, size=" + data.size + ", estimate " + data.wait + " seconds remaining";
        $("RequestID").innerHTML = data.requestid;
        $("StatusRequestID").value = data.requestid;
        $("ExportLocation").innerHTML = "";
        }
      else // status == 0 implies url_quick or url_direct format and all online as-is
        {
        var valuetable = "";
        var count = data.count;
        $("ExportButtonMsg").innerHTML = "Fetch your data at URLs below before starting next request";
        ExportReadyOK = 2;
        $("ExportButton").value = "Submit Export Request";
        $("ExportButton").style.backgroundColor = "#D8D8D8";
        $("RequestID").innerHTML = data.requestid;
        $("ExportStatus").innerHTML = "Data Ready, size=" + data.size;
        valuetable = CreateDataTable(data, valuetable);
        $("ExportLocation").innerHTML =  valuetable + "<BR>";
        if ($("ExportMethod").value == "url_direct")
          {
	  if (count > 1)
	    {
            $("ExportLocation").innerHTML =  "<B>Multiple files returned, direct fetch not possible. </B><P>" +
		valuetable + "<BR>";
	    }
	  else
	    {
	    var path = encodeURI("http://jsoc.stanford.edu" + data.dir + "/" + data.data[0].filename);
// doucment.write("<link type=\"application/fits\" href="+path+" />");
// fetch image
            }
          }
	else
          $("ExportLocation").innerHTML =  valuetable + "<BR>";
        }
      },
    onFailure: function()
      {
      $("ExportButtonMsg").innerHTML = "Export Failure, Problem at JSOC facility.";
      ExportReadyOK = 0;
      $("ExportButton").value = "FAILURE ...";
      $("ExportButton").style.backgroundColor = "#FFB0B0";
      alert('Something went wrong...');
      },
    onComplete: function() { $("AjaxBusy").innerHTML = Ajax.activeRequestCount; }
    });
  $("AjaxBusy").innerHTML = Ajax.activeRequestCount;
  }

function ClearStatus()
  {
  $("StatusButton").style.backgroundColor = "#D8D8D8";
  $("StatusStatus").innerHTML = "";
  $("StatusButtonMsg").innerHTML = "Waiting new status request...";
  $("StatusButton").value = "Submit Status Request";
  $("StatusRequestID").value = "";
  }

function GetStatus()
  {
  $("AjaxBusy").innerHTML = Ajax.activeRequestCount;
  if ($("StatusRequestID").value.length == 0)
    {
    alert("Enter Status Update RequestID");
    return;
    }
  $("StatusLocation").innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
  $("StatusDataLocation").innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
  $("StatusButton").style.backgroundColor = "#FFD8D8";
  $("StatusStatus").innerHTML = "";
  $("StatusButtonMsg").innerHTML = "Processing status request ...";
  $("StatusButton").value = "Processing ...";
  new Ajax.Request('http://jsoc.stanford.edu/cgi-bin/ajax/jsoc_fetch',
    {
    method: 'get',
    parameters: {"op" : "exp_status", "requestid" : $("StatusRequestID").value }, 

    onSuccess: function(transport, json)
      {
      var response = transport.responseText || "no response text";
      var data = response.evalJSON();
      if (data.status == 4)
        {
        alert("Requested RecordSet not found or specification error, status=4, error=" + data.error);
        StatusReadyOK = 0;
        $("StatusButton").value = "Bad Recordset";
        $("StatusButtonMsg").innerHTML = data.error + ", processing perhaps not started yet or bad RequestID";
        }
      else if (data.status == 3)
        {
        alert("Requested RecordSet is too large for chosen export method.  Please contact the JSOC for help.");
        $("StatusButtonMsg").innerHTML = "Export Too Large";
        $("StatusButton").value = "FAILURE ...";
        $("StatusButton").style.backgroundColor = "#D8D8D8";
        $("StatusStatus").innerHTML = "Needs Intervention, size=" + data.size + ", contact: " + data.contact;
        $("RequestID").innerHTML = data.requestid;
        }
      else if (data.status == 1 || data.status == 2)
	{
        if (data.status == 1)
          $("StatusButtonMsg").innerHTML = "Export request is being processed";
        else  // status==2
          $("StatusButtonMsg").innerHTML = "Export request waiting for processing";
        $("StatusButton").value = "Submit Status Request";
        $("StatusButton").style.backgroundColor = "#D8D8D8";
        $("StatusStatus").innerHTML = "Processing, size=" + data.size + ", estimate " + data.wait + " seconds remaining";
        $("RequestID").innerHTML = data.requestid;
        }
      else // status == 0
        {
        var valuetable = "";
        $("StatusButtonMsg").innerHTML = "Please only click once for status request.";
        $("StatusButton").value = "Submit Status Request";
        $("StatusButton").style.backgroundColor = "#D8D8D8";
        $("StatusStatus").innerHTML = "Data Ready, size=" + data.size;
        $("RequestID").innerHTML = data.requestid;
        var StatusLoc = "http://jsoc.stanford.edu/" + data.dir + "/";
        $("StatusLocation").innerHTML = "<A HREF='" + StatusLoc + "'>" + StatusLoc + "</A>";
        $("ExportStatus").innerHTML = "Data Ready, size=" + data.size;
        valuetable = CreateDataTable(data, valuetable);
        $("StatusDataLocation").innerHTML =  valuetable + "<BR>";
        }
      },
    onFailure: function()
      {
      $("StatusButtonMsg").innerHTML = "Export Failure, Problem at JSOC facility.";
      $("StatusButton").value = "FAILURE ...";
      $("StatusButton").style.backgroundColor = "#FFB0B0";
      alert('Something went wrong...');
      },
    onComplete: function() { $("AjaxBusy").innerHTML = Ajax.activeRequestCount; }
    });
  $("AjaxBusy").innerHTML = Ajax.activeRequestCount;
  }

</script>

</HEAD>

<BODY BGCOLOR="#FFFFFF" onLoad="CleanOnLoad();" >

<DIV ID="header">
<IMG src="http://hmi.stanford.edu/images/web/JSOC_120.gif"
  style="vertical-align:middle;height:60" alt="JSOC logo">
&nbsp;&nbsp;&nbsp;
<B><big style="vertical-align:middle">&nbsp;&nbsp;JSOC Show Info and Export Requests</big></B>
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;
<input type="button" value="reset page" onClick="InitPage();" >
&nbsp;&nbsp;<span id="AjaxBusy">0</span> Requests Pending
<span id='systemWorking'>, Loading...</span>
<!-- <br clear=all> -->
<HR>
</DIV> <!-- end DIV header -->
<input id="SeriesDivButton" type="button" value="Hide Section" style="background-color:#FFD8D8" onClick="ToggleSectionDiv('SeriesDiv');" >
<B>1. Find list of dataseries, and 2. Pick series to use</B>
<DIV id="SeriesDiv">
<TABLE style="width:98%">
<TR>
<TD  style="width:50%;vertical-align:top;">
Enter a dataseries match pattern to search for seriesnames, or leave blank to select from all series.
(A very bad idea now that we have more than 13000 seriesnames.)
A leading "NOT " means exclude names matching the subsequent pattern.
The default filter excludes namespace dsds.
<P>
<input id="SeriesFilter" type="text" name="filter" value="NOT ^dsds\." onChange="GetSeries();" >
<BR>
<input id="SeriesButton" type="button" value="Fetch seriesname list" style="background-color:#FFFF80" onClick="GetSeries();" > 
<input id="AbortGetSeriesButton" type="button" value="Abort" style="background-color:#FFD0D0" onClick="GetSeriesAbort();" > 
<br>
<span id="SeriesCountPlace" style="background-color:#FFF8DC;width:2em"><I>TBD</I></span>
Series match this selection filter.
</TD>
<TD  style="width:40%;vertical-align:top;">
Select data series here.
<BR>
<select id="SeriesSelect" size=8 onclick="PickSeries(0)"> </select>
</TD>
<TD style="width:60%;vertical-align:top;">
</TR>
</TABLE>
</DIV> <!-- /DIV SeriesDiv -->
<HR>
<DIV id="MySeriesDiv" >
<TABLE style="width:98%">
<TR>
<TD style="width:20%;vertical-align:top;height:100pt">
<H3>Information about selected series</H3>
Current Series is: 
<span id="Series_Name_Place" style="background-color:#FFF8DC"></span>
<BR>
<span id="SSKeysPlace" style="background-color:#FFF8DC;"></span>
</TD>
<TD style="width:20%;">
<span id="Series_Info_Place" style="background-color:#FFF8DC"></span>
</TD>
<TD  style="width:60%">
<span id="FirstLastPlace" style="background-color:#FFF8DC"></span>
</TD>
</TR>
<TR>
<TD colspan=2  style="vertical-align:top;">
<H3>3. Select Records and Get Record Count</H3>
Enter RecordSet Specification here for keyword listings and for export.
Request may take a while if the recordset is large (more than a few thousand records).
<P>
<input id="RecordSet" type="text" value="" onChange="GetRSCount();" > 
<P>
<input type="button" value="GetRecordCount"  style="background-color:#FFFF80" onClick="GetRSCount();" >
Record Count:&nbsp;&nbsp;
<span id="RSCount_Place" style="width:10em;background-color:#FFF8DC"></span>
</TD>
<TD rowspan=2 style="width:60%;vertical-align:top;">
<H3>List of All Keywords and Segments</H3>
<DIV id="SeriesInfoDiv" style="border:solid;border-width:thin;height:300;overflow:scroll">
<span id="SSPlace" style="background-color:#FFF8DC;"></span>
</DIV>
</TD>
</TR>
<TR>
<TD >
<H3>4. Select Keywords</H3>
Select Keywords for Detailed Lists
<BR>
<form id="KeysSelectForm">
<select id="KeysSelect" size=8 multiple=true onChange="PickKeys();" > </select>
</form>
</TD><TD>
<H3>5. Select Segments</H3>
Select Segments for Detailed Lists
<BR>
<form id="SegsSelectForm">
<select id="SegsSelect" size=8 multiple=true onChange="PickSegs();"> </select>
</form>
</TD>
</TR>
</TABLE>
</DIV> <!-- id="MySeriesDiv" -->
<HR>

<input id="FullInfoDivButton" type="button" value="Hide Section" style="background-color:#FFD8D8" onClick="ToggleSectionDiv('FullInfoDiv');" >
<B>6. Get Keyword and Segment Values Here</B>
<P>
<DIV id="FullInfoDiv">
RecordSet Query:&nbsp;
<span id="RecSetPlace" style="background-color:#FFF8DC;"></span>
&nbsp; Keywords to Fetch:&nbsp;
<span id="KeyListPlace" style="background-color:#FFF8DC;"></span>
&nbsp; Segments to Fetch:&nbsp;
<span id="SegListPlace" style="background-color:#FFF8DC;"></span>

<BR>
<input type="checkbox" name="Get Record Query" id="WantRecInfo">
Check to Get Record Query and online status and links if a segment selected.
<BR>
<input type="button" id="FetchKeyValsButton" value="Fetch Keyword Values for RecordSet" style="background-color:#FFFF80" onClick="GetKeyValues();" >
<input type="button" id="AbortKeyValsButton" value="Abort" style="background-color:#FFD0D0" onClick="AbortGetKeyValues();" >
<P>
<DIV id="FullDisplayInfoDiv" style="border:solid;border-width:thin;height:190;width:98%;overflow:scroll">
<span id="DisplayPlace" style="background-color:#FFF8DC;"></span>
</DIV> <!-- /DIV FullDisplayInfoDiv -->
</DIV> <!-- /DIV FullInfoDiv -->
<HR>

<input id="ExportRequestDivButton" type="button" value="Show Section" style="background-color:#D8FFD8" onClick="ToggleSectionDiv('ExportRequestDiv');" >
<B>7. Request Export of Desired Data and Get Status of Prior Requests</B>
<P>
<DIV id="ExportRequestDiv">
This section can be used to request an export of the RecordSet identified in Section 3 above.
<p>
If you wish a subset of possible segment files, specify the desired list in Section 5 above or using the "{<seglist>}" notation
after the then required closing "]" in the record query in section 3 above.  Do not do both.
<br>
You may preview the selection in Section 6 before requesting the export.
If the data is not online the request may take minutes to hours.
<br>
If you enter an email address you will be notified
when the data is ready. 
<p>
After the request is submitted, you will recieve ON THIS PAGE a "Request_ID" that will be used
to access the data when it is ready.  If you do not provide an email address you must save the Request_ID in order to
access the data.
<P>
<TABLE>
<TR><TD style="width:10em" >RecordSet</TD><TD>
<span id="ExportRecordSet" style="background-color:#FFF8DC;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span >
</TD><TD>Record set selected in Step 3 above.</TR>
<TR><TD>Processing</TD><TD>
<input id="ExportProcessing" type="text" name="ExportProcessing" value="no_op" onChange="ExportNop();" >
</TD><TD>Set based on Protocol to no_op for as-is or fullres for FITS.</TR>
<TR><TD>Protocol</TD><TD>
<!--
<input id="ExportProtocol" type="text" name="ExportProtocol" value="as-is" onChange="SetExportProtocol();" >
-->
<select id="ExportProtocol" name="ExportProtocol" style="width:15em"  inChange="SetExportProtocol();">
  <option value="as-is">as-is
  <option value="FITS">FITS
</select>
</TD><TD>Choose protocol, "FITS" or "as-is".</TR>
<TR><TD>Method</TD><TD>
<!--
<input id="ExportMethod" type="text" name="ExportMethod" value="url_quick" onChange="ExportNop();" >
-->
<select id="ExportMethod" type="text" name="ExportMethod" style="width:15em" onChange="ExportNop();" >
  <option value="url_quick">url_quick
  <option value="url">url
  <option value="url_direct">url_direct
</select>
</TD><TD>Choose method, url, url_quick, or url_direct for now.</TR>
<TR><TD>Requestor</TD><TD>
<input id="ExportRequestor" type="text" name="ExportRequestor" value="" onChange="ExportNop();" >
</TD><TD>Provide an identifier for you, e.g. your SolarMail name. May be omitted for online delivery.</TR>
<TR><TD>Notify</TD><TD>
<input id="ExportNotify" type="text" name="ExportNotify" value="" onChange="ExportNop();" >
</TD><TD>Provide your email address for notification.  You may enter "Solarmail" if your address is up to date
or "none" or "no" if you do not want/need to be notified upon export process completion. May be omitted for online delivery.</TD></TR>
<TR><TD>Confirm Email</TD><TD>
<input id="ExportNotifyConf" type="text" name="ExportNotifyConf" value="" onChange="ExportNop();" >
</TD><TD>Please confirm e-mail address.</TD></TR>
<TR><TD colspan=2 align="center" >
<input id="ExportButton" type="button" value="Submit Export Request" style="background-color:#D8D8D8" onClick="GetExport();" > 
</TD><TD><span id="ExportButtonMsg">Please only click once for export request.</span ></TD></TR>
<TR><TD>RequestID</TD><TD>
<span id="RequestID" style="background-color:#FFF8DC;">&nbsp;</span>
</TD><TD>This is the ID tag for your export request.</TR>
<TR><TD>Status</TD><TD colspan=2>
<span id="ExportStatus" style="background-color:#FFF8DC;"> </span >
</TD></TR>
<TR><TD>Data Location</TD><TD colspan=2>
<span id="ExportLocation" style="background-color:#FFF8DC;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span >
</TD></TR>
</TABLE>
<HR>
<B>8. Check Status of Prior Export Request</B>
<P>
<TABLE>
<TR><TD style="width:10em" >RequestID</TD><TD>
<input type="text" id="StatusRequestID" name="StatusRequestID" style="background-color:#FFF8DC;" value="&nbsp;" onChange="GetStatus();">
</TD><TD>This is the ID tag for your export request.</TR>

<TR><TD colspan=2 align="center" >
<input id="StatusButton" type="button" value="Submit Status Request" style="background-color:#D8D8D8" onClick="GetStatus();" > 
</TD><TD><span id="StatusButtonMsg">Please only click once for status request.</span ></TD></TR>

<TR><TD colspan=2 align="center" >
<input id="ClearButton" type="button" value="Clear Request" style="background-color:#D8D8D8" onClick="ClearStatus();" > 
</TD><TD>Clear old status RequestID</TD></TR>

<TR><TD>Status</TD><TD colspan=2>
<span id="StatusStatus" style="background-color:#FFF8DC;"> </span >
</TD></TR>

<TR><TD>Data Location</TD><TD colspan=2>
<span id="StatusLocation" style="background-color:#FFF8DC;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span >
</TD></TR>

<TR><TD colspan=3>
<span id="StatusDataLocation" style="background-color:#FFF8DC;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span >
</TD></TR>
</TABLE>
</DIV> <!-- id="ExportRequestDiv" -->
<HR>
<P style="height:1px">
<DIV id="footer" style="vertical-align:bottom;text-align:center;">
<I>Home pages for:</I>
<A HREF = "http://jsoc.stanford.edu/"><B>SDO-JSOC</B></A>
<B>|</B>
<A HREF = "http://sha.stanford.edu/"><B>SHA</B></A>
</DIV>
</BODY>
</HTML>

